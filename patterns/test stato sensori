### Pattern  
_Test di stato sensori_  

### Spiegazione del Pattern e Implementazioni  

**Modello Concettuale**  
Si vuole verificare lo stato di una serie di sensori su richiesta dell'utente o in base a una condizione specifica. L'obiettivo è eseguire un'azione (ad esempio, accendere una luce rossa) se almeno uno dei sensori rileva uno stato particolare (ad esempio, una finestra o una porta aperta). 
Differisce dall'allarme perchè non utiliza l'evento, ma verifica gli stati su richiesta. 

**Esempio**  
- Un'automazione di test che, se avviata, accenda una luce rossa se almeno un sensore finestra/porta è aperto.  

---  

### Implementazione 1 (Tuya-full)  

**Device**:  
- _Bottone smart_ per avviare il test.  
- _Sensori_ per rilevare lo stato delle finestre/porte.  
- _Luce rossa_ come indicatore di stato.  

**Codice**  

```  
test_sensori: 
SE (trigger(test_device("Switch", "button1", "=", 'single click')) 
AND ambito(
    test_device("sensore1", "Sensore porta", "=", On) OR 
    test_device("sensore2", "Sensore porta", "=", On)     // OR... more
)) 
POI (
    set_device_status("Luce rossa", "switch", ON)
) 
```  

**Logica**:  
1. **Trigger**:  
   - L'automazione viene attivata quando il bottone smart viene premuto.  
2. **Ambito**:  
   - L'azione (accensione della luce rossa) viene eseguita solo se almeno uno dei sensori (sensore1 o sensore2) rileva che una finestra o una porta è aperta.  
3. **Azione**:  
   - Se la condizione nell'ambito è soddisfatta, la luce rossa viene accesa.  

**Vantaggi**:  
- **Semplice e diretto**: L'implementazione è facile da configurare e gestire.  
- **Flessibile**: Può essere estesa per includere più sensori o condizioni aggiuntive.  

**Svantaggi**:  
- **Tuya-full**: Poichè richiede l'uso di AMBITO, non può essere implementato con Tuya-local.

---  
### Implementazione 2 (Tuya-local)  
**Device**:  
- _Bottone smart_ per avviare il test.  (Zigbee)
- _Sensori_ per rilevare lo stato delle finestre/porte.  (Zigbee)(
- _Luce rossa_ come indicatore di stato. (Zigbee)

**Codice**  

```  
Verifica_sensori:
SE (trigger(
      test_device("Switch", "button1", "=", "single click")
    AND test_device("sensore1", "Sensore porta", "=", "Off")
    AND test_device("sensore2", "Sensore porta", "=", "Off")    // esempio: de sensori
))
POI (
    set_device_status("Luce rossa", "stato", "Off"),         // spegne...
)

Controllo_sensore_porta:               // una automazione per sensore
SE (trigger(
        test_device("Switch", "button1", "=", "single click")
      AND test_device("sensore1", "Sensore porta", "=", "On"))
)
POI (
    set_device_status("Luce rossa", "stato", "On"),
)

Controllo_sensore_finestra:          // esempio, secondo sensore
SE (trigger(
        test_device("Switch", "button1", "=", "single click")
        AND test_device("sensore2", "Sensore finestra", "=", "On"))
)
POI (
    set_device_status("Luce rossa", "stato", "On"),
)

**Logica**:  

**Vantaggi**

-------
